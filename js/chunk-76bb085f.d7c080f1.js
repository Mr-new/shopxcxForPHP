(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-76bb085f"],{"24a7":function(e,t,i){},"64dc":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 规则管理")])],1)],1),i("div",{staticClass:"container"},[i("quill-editor",{ref:"myTextEditor",attrs:{options:e.editorOption},model:{value:e.content,callback:function(t){e.content=t},expression:"content"}}),i("el-button",{staticClass:"editor-btn",attrs:{type:"primary"},on:{click:e.submit}},[e._v("提交")])],1)])},o=[],r=(i("fa26"),i("3040"),i("cac2"),i("1e58"),i("b881")),a=i("b049");r["Quill"].register("modules/ImageExtend",a["a"]);var s={name:"editor",data:function(){return{content:"",editorOption:{modules:{ImageExtend:{loading:!0,name:"image",action:this.$api.uploadUrl+"/Images/uploadEditorImage",response:function(e){return e.data}},toolbar:{container:a["c"],handlers:{image:function(){a["b"].emit(this.quill.id)}}}}}}},components:{quillEditor:r["quillEditor"]},created:function(){this.getData()},methods:{onEditorChange:function(e){e.editor;var t=e.html;e.text;this.content=t},getData:function(){var e=this;this.$api.post("StepRules/getRulesList",null,function(t){e.content=e.escapeStringHTML(t.data.list.content),console.log(e.content)},function(t){e.$message.error(t.msg)})},escapeStringHTML:function(e){return e=e.replace(/&lt;/g,"<"),e=e.replace(/&gt;/g,">"),e=e.replace(/&quot;/g,'"'),e},submit:function(){var e=this,t=this.$qs.stringify({content:this.escapeStringHTML(this.content)});this.$api.post("StepRules/saveRules",t,function(t){console.log(t),e.getData(),e.$message.success(t.msg)},function(t){e.$message.error(t.msg)})}}},l=s,c=(i("d465"),i("17cc")),u=Object(c["a"])(l,n,o,!1,null,"02af13b0",null);t["default"]=u.exports},b049:function(e,t,i){"use strict";i.d(t,"b",function(){return n}),i.d(t,"a",function(){return o}),i.d(t,"c",function(){return a});const n={watcher:{},active:null,on:function(e,t){this.watcher[e]||(this.watcher[e]=t)},emit:function(e,t=1){this.active=this.watcher[e],1===t&&r()}};class o{constructor(e,t={}){this.id=Math.random(),this.quill=e,this.quill.id=this.id,this.config=t,this.file="",this.imgURL="",e.root.addEventListener("paste",this.pasteHandle.bind(this),!1),e.root.addEventListener("drop",this.dropHandle.bind(this),!1),e.root.addEventListener("dropover",function(e){e.preventDefault()},!1),this.cursorIndex=0,n.on(this.id,this)}pasteHandle(e){n.emit(this.quill.id,0);let t,i,o,r=e.clipboardData,a=0;if(r){if(t=r.items,!t)return;for(i=t[0],o=r.types||[];a<o.length;a++)if("Files"===o[a]){i=t[a];break}if(i&&"file"===i.kind&&i.type.match(/^image\//i)){this.file=i.getAsFile();let e=this;if(e.config.size&&e.file.size>=1024*e.config.size*1024)return void(e.config.sizeError&&e.config.sizeError());this.config.action}}}dropHandle(e){n.emit(this.quill.id,0);const t=this;e.preventDefault(),t.config.size&&t.file.size>=1024*t.config.size*1024?t.config.sizeError&&t.config.sizeError():(t.file=e.dataTransfer.files[0],this.config.action?t.uploadImg():t.toBase64())}toBase64(){const e=this,t=new FileReader;t.onload=(t=>{e.imgURL=t.target.result,e.insertImg()}),t.readAsDataURL(e.file)}uploadImg(){const e=this;e.quillLoading;let t=e.config,i=new FormData;i.append(t.name,e.file),t.editForm&&t.editForm(i);let o=new XMLHttpRequest;o.open("post",t.action,!0),t.headers&&t.headers(o),t.change&&t.change(o,i),o.onreadystatechange=function(){if(4===o.readyState)if(200===o.status){let i=JSON.parse(o.responseText);e.imgURL=t.response(i),n.active.uploadSuccess(),e.insertImg(),e.config.success&&e.config.success()}else e.config.error&&e.config.error(),n.active.uploadError()},o.upload.onloadstart=function(e){n.active.uploading(),t.start&&t.start()},o.upload.onprogress=function(e){let t=(e.loaded/e.total*100|0)+"%";n.active.progress(t)},o.upload.onerror=function(e){n.active.uploadError(),t.error&&t.error()},o.upload.onloadend=function(e){t.end&&t.end()},o.send(i)}insertImg(){const e=n.active;e.quill.insertEmbed(n.active.cursorIndex,"image",e.imgURL),e.quill.update(),e.quill.setSelection(e.cursorIndex+1)}progress(e){e="[uploading"+e+"]",n.active.quill.root.innerHTML=n.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,e)}uploading(){let e=(n.active.quill.getSelection()||{}).index||n.active.quill.getLength();n.active.cursorIndex=e,n.active.quill.insertText(n.active.cursorIndex,"[uploading...]",{color:"red"},!0)}uploadError(){n.active.quill.root.innerHTML=n.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"[upload error]")}uploadSuccess(){n.active.quill.root.innerHTML=n.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"")}}function r(){let e=document.querySelector(".quill-image-input");null===e&&(e=document.createElement("input"),e.setAttribute("type","file"),e.classList.add("quill-image-input"),e.style.display="none",e.addEventListener("change",function(){let t=n.active;t.file=e.files[0],e.value="",t.config.size&&t.file.size>=1024*t.config.size*1024?t.config.sizeError&&t.config.sizeError():t.config.action?t.uploadImg():t.toBase64()}),document.body.appendChild(e)),e.click()}const a=[["bold","italic","underline","strike"],["blockquote","code-block"],[{header:1},{header:2}],[{list:"ordered"},{list:"bullet"}],[{script:"sub"},{script:"super"}],[{indent:"-1"},{indent:"+1"}],[{direction:"rtl"}],[{size:["small",!1,"large","huge"]}],[{header:[1,2,3,4,5,6,!1]}],[{color:[]},{background:[]}],[{font:[]}],[{align:[]}],["clean"],["link","image","video"]]},d465:function(e,t,i){"use strict";var n=i("24a7"),o=i.n(n);o.a}}]);